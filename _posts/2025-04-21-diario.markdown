---
layout: post
title:  "Di√°rio de MAC0470"
date:   2025-04-21 17:25:15 -0300
categories: post
---

Aluno: **Antonio Fernando Silva e Cruz Filho**

Dupla: **Andr√© Nogueira Ribeiro**

Esse √© o meu di√°rio de trabalho da disciplina MAC0470 - Desenvolvimento de Software Livre. Aqui, documento todas as atividades realizadas na disciplinas, apresentando tanto as dificuldades quanto momentos de sucesso. Eu e minha dupla fomos selecionados para utilizar o kw para contribui√ß√µes ao Kernel Linux na disciplina.


### **Di√°rio de Trabalhos**

#### **Semana 26/02**

Realiza√ß√£o do primeiro tutorial. Inicialmente tive dificuldades pois n√£o tinha computadores com Linux. Visando consertar o problema, resolvi instalar Linux no meu computador pessoal. Entretanto, o mesmo √© muito pesado para transporte, ent√£o resolvi levar o meu outro computador MAC mais leve para as aulas. Para poder acompanhar as aulas, instalei SSH no meu computador pesado e utilizo o programa [ZeroTier](https://www.zerotier.com/), um programa capaz de definir uma VPN pessoal sem necessidade de abrir as portas do meu roteador.

#### **Semana 12/03**

Realiza√ß√£o do segundo tutorial sem muitas dificuldades.

#### **Semana 19/03**

Realiza√ß√£o do terceiro tutorial. Tive dificuldades por conta de um bug provavelmente relacionado com um erro de digita√ß√£o e acabei conseguindo mitig√°-lo ao fazer o tutorial 1 e 2 novamente.

#### **Semana 26/03**

Tive um pouco de dificuldade de entender o quarto tutorial, por√©m depois de m√∫ltiplas releituras, pude entender como _Character Device Drivers_ funcionam (o suficiente para poder continuar com as contribui√ß√µes com o Kernel Linux).

#### **Semana 02/04**

Realiza√ß√£o do tutorial 5 sem muitos problemas.

#### **Semana 09/04 + Break**

Escolhemos a sugest√£o _"Add prefix to DC functions to improve the debug with ftrace"_ para realizarmos nosso primeiro patch. Tal tarefa tem como objetivo renomear fun√ß√µes de diferentes escopos que possuem o mesmo nome. Essa mudan√ßa possibilita que o usu√°rio entenda facilmente qual fun√ß√£o est√° sendo executada ao utilizar o *ftrace* (ferramenta de debugging). Primeiramente, clonamos a [branch](https://gitlab.freedesktop.org/agd5f/linux) correta do subsistema AMD e encontramos a possibilidade de melhoria no arquivo _drivers/gpu/drm/amd/display/dc/dce80/dce80_timing_generator.c_. As modifica√ß√µes realizadas foram:

```diff
diff --git a/drivers/gpu/drm/amd/display/dc/dce80/dce80_timing_generator.c b/drivers/gpu/drm/amd/display/dc/dce80/dce80_timing_generator.c
index 003a9330c..88e7a1fc9 100644
--- a/drivers/gpu/drm/amd/display/dc/dce80/dce80_timing_generator.c
+++ b/drivers/gpu/drm/amd/display/dc/dce80/dce80_timing_generator.c
@@ -105,7 +105,7 @@ static void program_pix_dur(struct timing_generator *tg, uint32_t pix_clk_100hz)
        dm_write_reg(tg->ctx, addr, value);
 }
 
-static void program_timing(struct timing_generator *tg,
+static void dce80_timing_generator_program_timing(struct timing_generator *tg,
        const struct dc_crtc_timing *timing,
        int vready_offset,
        int vstartup_start,
@@ -185,7 +185,7 @@ static void dce80_timing_generator_enable_advanced_request(
 
 static const struct timing_generator_funcs dce80_tg_funcs = {
                .validate_timing = dce110_tg_validate_timing,
-               .program_timing = program_timing,
+               .program_timing = dce80_timing_generator_program_timing,
                .enable_crtc = dce110_timing_generator_enable_crtc,
                .disable_crtc = dce110_timing_generator_disable_crtc,
                .is_counter_moving = dce110_timing_generator_is_counter_moving,
```


Para garantir que as mudan√ßas n√£o quebrariam a compila√ß√£o, foi necess√°rio estudar os arquivos *Makefile* associados para entender como habilitar a compila√ß√£o da parte do c√≥digo que alteramos. No nosso caso, a configura√ß√£o habilitada foi *"DRM_AMD_DC"*. Ap√≥s garantir que a mudan√ßa n√£o gerou erros de compila√ß√£o, seguimos o tutorial para enviar o patch para o email freesoftware2025@gmail.com.

#### Semana 23/04

Seguindo a sugest√£o do David, melhoramos nossa mensagem de commit e realizamos o envio do Patch com sucesso. Em pouco tempo, recebemos uma resposta positiva do mantenedor: Nosso Patch foi aceito! [(Link Patch)](https://lore.kernel.org/amd-gfx/CADnq5_OrVtVXCoDxZU8ngFpDywFj3c6Wx-MOt2DJUdiU3SKp2w@mail.gmail.com/T/#t)

#### Semana 30/04

Realizamos a busca por nosso novo projeto de Software Livre. Decidimos seguir com o GNOME, por conta de sua comunidade tipicamente ativa, clareza em issues para novatos e projetos interessantes. Incialmente, decidimos contribuir para o GNOME Music, por√©m, depois de n√£o recebermos respostas a nossa mensagem inicial no servidor de conversas do projeto, decidimos contribuir com GNOME Calendar, dado sua comunidade ativa. N√£o conseguimos entrar no servidor de conversas deles, mas mandamos uma mensagem em um Issue que pareceu interessante. 

#### Semana 07/05

Enfrentei diversas dificuldades com a instala√ß√£o do ambiente de desenvolvimento GNOME. Incialmente, desejava compilar o projeto pelo meu terminal, possibilitando o desenvolvimento remotamente usando SSH (Mesmo n√£o podendo ver a interface do programa, poderia ver se o mesmo compilaria). Por√©m, n√£o consegui de forma nenhuma compilar o projeto pelo terminal. Acabei instalando o Builder em minha m√°quina e utilizando sua interface. Costumo a utilizar meu MAC, por√©m a tarefa se tornou um pouco mais dif√≠cil, j√° que n√£o poderei mais utilizar SSH. 

#### Semana 14/05

Os desenvolvedores do GNOME Calendar apontaram que nossa issue inicialmente escolhida pode n√£o ser uma boa primeira issue. Assim, decidimos alterar nossa issue para a [#717](https://gitlab.gnome.org/GNOME/gnome-calendar/-/issues/717), que se trata da implementa√ß√£o de um setting de disponibilidade para eventos individuais, permitindo defini√ß√µes autom√°ticas de *N√£o perturbe* e bloqueamento de outros eventos na agenda durante o mesmo hor√°rio. Explorei a estrutura do c√≥digo visando compreender como a interface do programa √© constru√≠da e como poderemos adicionar novos elementos com novas l√≥gicas de neg√≥cio envolvidas. 

#### Semana 21/05 + Break

Ap√≥s uma boa an√°lise do c√≥digo e dificuldades em replicar o problema antes mencionado, acabamos decidindo mais uma vez escolher uma nova _issue_. Seguindo recomenda√ß√µes dos mantenedores, resolvemos trabalhar na issue [#1021](https://gitlab.gnome.org/GNOME/gnome-calendar/-/issues/1021). Dessa vez, conseguimos replicar o bug sem muitos problemas. Utilizando logging e buscas avan√ßadas no reposit√≥rio, localizamos a fun√ß√£o que precisava ser modificada no contexto do problema. Ap√≥s consertarmos o bug seguindo o conselho do _Jeff Fortin_, criamos nosso MR: [!583](https://gitlab.gnome.org/GNOME/gnome-calendar/-/merge_requests/583).

#### Semana 04/06

Depois de pouco tempo, recebemos feedback para nosso MR. Ap√≥s poucos ajustes de mensagem de commit, o Jeff validou que nosso MR realmente funcionava. Entretanto, outro desenvolvedor acabou se envolvendo na discuss√£o e apontou que nossas mudan√ßas poderiam dificultar o merge do seu respectivo MR. Al√©m disso, o mesmo opinou que nossas mudan√ßas alteram o comportamento do app de uma forma n√£o desejada.

Depois de esperar o merge do outro desenvolvedor, propomos uma nova abordagem para a nossa implementa√ß√£o. 

#### Semana 11/06

Por enquanto que esper√°vamos _feedback_, foquei em realizar o setup para o workshop de Debian. Acabei enfrentando um problema onde minha m√°quina virtual simplesmente n√£o executava o programa _Hello_, que serviria como valida√ß√£o se minha instala√ß√£o tivesse dado certo (n√£o foi o caso üòÖ). Acabei descobrindo que a forma como eu estava aumentando a mem√≥ria da minha m√°quina virtual estava incorreta. Ao inv√©s de expandir a parti√ß√£o virtual onde estava o sistema operacional da m√°quina virtual, eu estava criando outra parti√ß√£o acidentalmente. Com o problema resolvido, consegui realizar o workshop sem muitos problemas!

Quanto ao MR do GNOME Calendar, ainda n√£o recebemos feedback. Durante o tempo de espera, investigamos como poder√≠amos implementar a solu√ß√£o que propomos, mesmo sem ter recebido feedback ainda.

#### Semana 18/06

